# Week #025 ~ #028


## 有用資源
- Psycopg 使用說明 [[連結](https://www.psycopg.org/docs/)]

## `with` 陳述式與交易處理

在 Psycopg 中使用 `with` 陳述式可以有效地管理資料庫連線和交易。當程式碼區塊在 `with` 陳述式中執行時，它會建立一個交易上下文。如果在該區塊內發生任何例外情況，交易將會自動回滾 (rollback)，確保資料庫的完整性，避免部分完成的操作。相反地，如果 `with` 陳述式中的程式碼區塊成功執行完畢且沒有引發任何例外，則交易將會自動提交 (commit)，將所有變更永久保存到資料庫中。這種自動管理機制簡化了錯誤處理，並確保了交易的原子性，即交易中的所有操作要麼全部成功，要麼全部失敗回滾。

此外，當使用 `with` 陳述式管理連線時，無論程式碼區塊是成功退出還是因例外中斷，連線 (`conn`) 都會在 `with` 區塊結束時自動關閉。這表示開發者不需要手動呼叫 `conn.close()`，從而減少了資源洩漏的風險，並使程式碼更加簡潔。
